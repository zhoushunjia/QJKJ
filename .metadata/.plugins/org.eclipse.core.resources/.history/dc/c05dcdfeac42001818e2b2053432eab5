3{!s;+&{uK4>yx
zNff!!oQ<*j4w~yxjx_FS+tWt*TlbmgZ>$ZVGeI8YZBXLXTovM_BkIZ(3AU$56lWXM
z)@?t+yqvUE&{Ng6XC(C${;ZSOSCgfc<Ztt#DaP#6=kidr`D`~F$xZ-B{SLE^$yo$^
z44PLRQnYd2VIaFSKLr{m{8Dv|itsaXQpXti0p<&$Qb~eyr|ST{x!>AlITOMu_@+o4
z^`v^o_u_^G%o|h5HxBrw+$=V;aEjjU+G-)U5+J7^??4rD>Lk={=<EYQT3Stb#(3AK
zWPMKAfPmFC$P51HYeGpdmC~kQ5OsBArg?yk{MzC&jt(YKd{R9fnNMQd?liX&HUtJH
z5Q*k~phk2hBQ6eq2v$)@z~Etn{ZI@-`!V;JYhvEr`b+Z_u!jP46(mv&LFgkk-15Vw
z3|0XfYzg`J`P90IjLRj`^J-?yR5s)CuxUnJ3<FE`KF;+Gvfc=EVc+Q&+U_=_c^c2^
z@_DfwqfD|MJ=zOK+ob3w+J)n1tLbTc2lcmqvh(#g9eZc23tzLNL2MbDGMxo0YI0<R
zhyFQ{beckn(HV%)){^BYd*7RKDD6`{6x>)^$I|ktuzp7;hPG3>Y@F67J6DkNnwcWZ
zyg(|7Q+MRGwwLPJ1h>ZHAs=OTuEa)J(=D}WK02AF3mPnSMRjB95Dc(ls079BE8HCG
zv|vyT4J9QhG!#sXPny>T+-<oU<V{I{vw-XdJ`A&PG7RhAvEC0%I+fHXjJRZOgyw)5
zK|*glM#6phWC9JOyhm`e=N+8GphMV&k9VFxlp`>pk%@|0gn^1c&=Lc{LwsH3uul`R
zgp_%E&&VmoUQ8L8fjv+Sk0VcIOX9xErp!_`P>PB^YTgbivijS)8>B>wHs^%P!LbxI
zo03Rl6z{Rn(kmITT`o{GN63vYnNQQ{>k3@SsO<rtJMYHxm;R(1Lk4GjO*72Jf2A|C
z{oy}seh^%A)yDb~a0FUlq7<J@VPUJ?Sl6D3J!AC~pLZ&2=lSL(bc+?LMc2opP4-Z_
z3r1M8+9vCQhORn8J%Nf8ljVv4<0$5HTENQ580_r)gSmy=4cu{w=CYd|iKe6e2L2*x
za&Exn6*zX|{}g0r4^{zIzP=&97dh`zO8zw!Q9XL_2=h!_9CdtS9eKdK7spSoRg1&Z
zL^V{C)k6FZ7*QsH4vQ_eG3cQlF%E4Hzu{@+UziUNxl&#!wA$5hTdAAXZdU>_=hL%N
z`;e9{`L7?C>(^(4>Eg^A#m4z>K;WQl2jMory3`6_72B*0>(9G^9jWPY7>5w7OnA5n
zH?pTaGtyOSLx6x6be6;p6{c|at}?hFLR6nN|6n`t<<H+ivx;mJg+dWq2%bwqLw?C6
z#mVmQxCGk5NTmf00U@7S8jo%x$4bV8v(eoMiPncB^u)sfi(tV0BqrB4_b+natQlY_
zf4A#4j=#d+#o^y;-cH(vju@YhN-pegauDhb*^}U4I|NWKvhcO3Y!eA;+<u(7LlS!i
z(oNNpx_6d{+R0YFIzRxDC8I0FK3>7Ad0hKEXYQU|g}acWL}5CA`iqWHxCQkT&k-+|
z!gG8XIA2wS0ar|)nnYc_vC5IB!!}^Fch}L`l*&8JudmfT=)wv?Zimxly4yKlrwwbj
z7k?TDk4Gp$D;o!oU%-Yv#e6^H9OLyv6sCh@b38#Ho>>AKEq!9KB(cQ8HcXTXv-4i_
ziN<yz0q58dEpMU4)8si{48;+#%&=jOqSZZABUbEPwq<Y&O5Zte)`oQN_FA7Jp{GU)
z_|+((jdhzZ(nHpl-dJXZ03KNv5Ox?Y_667ed|&75(xt?;<gZ5jK95mSdnzKFIIh>;
zR1D<4BF`kyP+GP`p!li<G1uOJ;J(lN7W*{G@1=?2&bw)^B*?=LfoFkT+LgNZT-yUW
zq#i@0y5qK1yU5S1fW4M`2az9WgM<X9=r7mz#}jHC#g`0v<ayye=GR~WgFToBLvM*Q
zDe^jgM)nZ#&`Xb0<P8-p1SJ}C#F4y&8$9^58dx%51!a%g5e5s(^Mxpegp|3<90M`Y
z=LwY!S2r}e;?0+R`OkI{=ORmnEoc$*JA=-H_-OIH)5A0NmJJG`6I@eznxg#);we)x
z3nk3^fI#TWBu6OJ1}{;Qi;_&lq!`ExHK+W(i_EDJriFQ4z%`{KQE3<|dKKS}#V8*e
zU2oSp&oaBP$-x}GOank~9_RM=m{*Y<>JJZ0?Q|2zn_AeO-uykWvAW9GbEXZf$?V#0
zusurcyS$SV5zz@j@?DlE%{LEx9wm$<_PKr$^-2FXDeNGsV6zMaj1pj-&5Og=xdfxi
z^)B*5j$SR@R5S|_8XEE-$7T|f?tI0(^DJ_1A<sNfM%~DB=!j^$>q%63DRLGj&(yyI
z@3<!U*&z>TRp=CG+jtR}=^f@*q;q^2=Vy+fo^5iS%s~kD+0MZ#$>1dNzraxHo$jN1
z&zNp;y`{f+7C^X1wmEJK9rRYAYI<URalfOOg?F~h9}{qE1fN5#Srg2M`FWArn|w<+
zi8Z8VObPl~hoxM)nYvlV^QW%1V284l3rZ(a_xQOKgzXLU=jsX&_n9gkbyq0V2((U#
z2HO)J&vWW%-cy0;K?J5Kk!gSGm!M`}Wd1W8F<w?Oo8eLry1c{vD#8pVVb(RowG=$)
zvRqJB2w981>?zK2qmYaoLC%X83JViuy7hSTOz~nIU*(pyr+nQ4>1_Ruig^07z3IHL
zH#A{U+0piqLhUl*>Jle%<~ca`wdQW@68eiTQ@5#@Dryuj`f{H2S&1rA2?dF?E$j(u
zP<2?hDccV<Z-zK0@0vOjuoVp$CX=yG$eap$lGL%_i)e>Lgloi(kG%Pw)E@`4LsG<}
z%$wxhL!7$I2(^B8M=o1YraiS_Kq5a@OuncWrI{n_^7V9?3$;9>ba-4bcWLm8$X#sI
z_jHbh5v#h?2}7Rq1H`Y~0|OGowTPAb<0=e3WUU5glIP~)snQ=)BCV-_+Ignvd#MO$
zPI?JV*8`z_>%0|_$f%G#JvJQraq}rKusw8d!bkiOLkwlBtjKF@(m+d{Qkp2Y%JP(m
zCfAz&BJy17{JcoGy7O;EPL>+v(jt{6G~-bdk){|VEE~mQ{VFsH&iWJi9C&WpXRBM<
z03_YK-=Git5nR?woNOb8{Lg)9S?BSfXp9B*qipreGaw(-s9|j(BsI_SKmEA|;Xtt9
zKy&8l_SczLrf4_iFboI380BMA*^=a^<9fo|XWnCpRFRQr$c8$)bpFhw7omkKC_P1J
z{A<mdD_=2w)X5HAA-{MT+X%DOVk0Bg<>*acRUH@R%v%JZYkX6a_Z1vnqP~EkP1V!`
z&0iqa0^b0d?Y$BNBrZ@%0f8dp|A2VppIgQyUANJ8<^k;$xm^=UP&7kCg{<5D{?2g`
zt=2T7EE;dR*X5}w5-!!L|4Bt{S*y$@X@fas;$y6Q=%YOqk-gxh{6Y@QO?=zVqNx$f
z-&P-oAby`Y2l44>69v%+F-i7oS|{1w1z_rs0I8Qh!IyCj)Z3>ncOFyG2M93CvsMX~
zmh4NCW&=r{3x3%rTpeBN^RUWZZT_@Y14c9@y+Lf`SZ52zI`H@013vSbJCZ=1wM}q|
zOM)4bP7oVYWzwO&<BJP8ZQs)i1T3_`H1mMp?pDhv28*s;fRz1(&i?|&kMpsuemTlk
z!uS+i>Bq;m#TNF!ZkUH~yD`F@dP}a{tNW%`lSfO`KL<)NwH^MG*_bCHK_3wWNv=3i
zpnI~|Vi1LoH$TjQxoAq6!)6l8e+2Y=KGLSvoglaGp1gJWGSn7daSAQ@P&&!E2DNf+
zqG6T}q{aM2k~f+cQi2RLk?`F?c*usUXC_n3rXs5a%x87EwUJ`=o}AFu8_j!x1Fsn@
zEK+6{#m7k~*nJm6HjX!BeQYW7EuAl8rGVP$iBU>H9(lW4cpJ2Fzj+UqHNU!A$tCW9
z!fKe%`l1@Gx;mZaMvT-FR-LuXV&$k4CT&z7k}&ZwIa!>V4gbuU``7AX4UyIPRa(##
z&60!ds#~m&DDbco?e;<hhRpKhO6@0dS)f+7UA*r4bYt=Go8X>vuJp^xi85ogr&%v-
zi}D*PM4Sb?7ucs4QB=6Pv36**vR185#Bm9mlFEXSUw38%c@dTiPn@qaSFg*W)CCls
zPkQHO^BQa0V~}&My^|8BS|tKcFasg7y{r3|MjT4I$zj3Dck<m>@z`WzM=~mx6jDG<
z@fR`Bm(2$oG$yi16|t9$@!sTp95$a|20F9BZ@ao^oED~M>NP;3Bb{#mCO(XWOlq#g
zrHOoF20Ir>8^IQ>{dF|9-}0zvS1Of-AUnUa7xh%^pzW1d48n&cQXrusu{(enLYaDp
zS5~8Sa0Cz(&#E}^-Ca1=c>*Hr6c<QTN%4HFN11JMjjoq1tcn~4U5Qmp$<_#ga4CkA
z6uFGA0{^(i*LkWM`xLK@6qxxgGC63?A|m*tR(T~p31{+K&HpGllXH3SIZl_UMgfJK
z!ph9Eq=j>%I*fk+y>^z^$Qmvtg%E9;WW;ZOi}?(#ocRVmbCF;oAPH7bR!!&(&kKgk
zLZmHOsE*s`I89-ZCYSMavoZ3mKQm8-&^RKgKy1H8g%CMy<JmZHJ~HcZY0lR7cAhR;
zr+`~7Eky)$?pR05$}HQYu}+Thl*DS%S6Of^Huq~;9J8`yaWF9FL(DG|i8AMY?PUw|
zw6ZjZT;cbE<{Fx3&oO%g-qsF0&{}pf3HuyKuO7&x_iU)wz6W42*ZH=rt|6x%Aw9}~
zkTd&7tZQZ^<+OJBc~0u`xh`}anM0qAVml|sbMlCowl0YzfVXp(`57yU@O>NO^hso)
zAm5kvNR_0xlrm(US-DsJ_#!@l-u~FE^iRXmnMX1?(Tnwj#&&rf5l4TWr#<+<&lDCx
z1@S?$Asm^@d`%y2c+jSev`3`iX4vs5R*?T3xa2wPw|(;Z`r4u8VYP~~e@b&~ApK}v
zxi!gBQlnD=eSHiJe!uzbaN>N%p7sbEyPt31x|$+1Aw8D?BVI2C31I0INTQ8ii|zqe
z+!VOdw2Mx{okBr}1s7ku!@Q7WthN&**?Q5pcn3Zx=Nj}fc3OyO>&@ob5@O0IHxCtJ
z>$7wgNt??>zSXc2Yu&n7?leD$ok4CUb*Z#mRwlq17%N4M@le#dq4OWDj~?d(CQyfb
zy;~cJf#`4WMAALP)9Rdw&1)X3b$n`S4=Wna!kL<;Jf~NV!hLvdxL8SF;snHsrc3)K
z_1g`dp&y*u1*`Ev?B6}+M`~#6M%*KX+aE(IW;L^tfWY@$Rf$^g`S6Q<LY?r@XW90C
z5aTgLn80KwMkB>I`n34wwZ(uw8>yfYu_qG0BwdO`Ns<%F_Ovw?SP&)7vIb!Z&yAC7
zg5^{<y|+GLetlfw9`y>he^6Bqm-<|6Y&P-+1nBJ`0GZf1Wf5hi7S}-V^ZP3|H{9jN
zi(ps2JP1;|-@IaRv<jBv!b}cBof`40{NE(9<XK9hrw~Ee71<3_^FzmL%9#%u$EmDu
z%1FA&JU<QFZ~s`-p8hBbW7pP5N^Fc5zshau5nSwHGIA`5xJgP<;+?L(gUvr>egKlX
z);_t$*P=@{;SkAr2fIsAY_)mFJFhhFwerNf!QgbK!*x6m;Gq(WrnxYp+mP#;pHEmI
zG!>kFYQu<i(eA|FE9&M5taFc<!2QG)$5n%+(IN_E?9S1$VwFU4x=gppWkqdMX@*w8
zu9*KSYdo|(njrNT<7rq#QI^0Lu?#prvY6Mc$rfD*lWa47eW-SYhFx?pAcbL0M-2sd
z9#QV*Cg^T{u%fvz0ZM=wx8gl*0u~Er!%#8R2vTaWn`1ziyuf^!bcx{8s@Z|!Al<)*
zP4xg)Gy2M&%Rt0;2byu{@tcEmDQXRHt=&=2DhZMmz?Gs{{~=YS{zLF<Ty0Kb>s60)
zwdO7?k_3-G$Glh8d^uy}ezDnj(#6(*z6{%?7|HkQiTQiB(#z1p*xoN$FTr6q;Ld%W
zuGrqpVpNGZI0|R{ZT(I4!G-}_%D=DwJ~i!$)A4I)H-H8_upKiK++_U2uecnisnbO-
zC6Yz<!$t8-U+(IcyHmdm0dS>x#&GrA2$jm9eJ9<?ok78jdHhNHZ4@Mr%EK;w%03_5
zI<@`b&bP9Y8yyW1HRNf9#gqWBmeCcwB43=J;+$1Na`nu~5XWAePdr3MSwu&oRjziL
zDSl#acxuev8a}yVvaQdXAxS1~vP|c44PxhqZ5H4~9Z4G4z2CgFV!h6(8eV(X`J=42
zyAko#jY5k=lv2{Uj4}(#qVyX6QRXQ2g6<$7%~*}EAC1>(Py8=b1eEjDIWH7qVn8aN
zH*Z90IG9Panxl8M*m7`7ZMIbDOOhh&3%z)R7V*~j1u*DSI$w{(6AL}BK_OgFpT?~K
z!?vPmmEO+VYjLVnt|{VTDlduQHf&(O+~fYJJ?=2SKJKqhq@vDdb!^ra0(*}e4ceD$
ze+@ehKF{1QQXWg4kSQ)ZgRVdvCnNV7lsxsHuk8yY%wS`2sy`#YF;dtJpgT)#B1)W7
z5C>l=-M9po<a%{}ozSC)irddL&t|DGIqSu<l*<r5@O^YDBy#M)7@qmm<{<O;Q`kuv
zwM&i~9S?TWR%Z^AAn_}9p~V3x4UKWY?r?tKLzvQ$vni_e0`L+Qr_MrI)vt-X4^9-J
zec`~Zmh{nNKi?f)@rB}HjqKI70*-_iqe7aA?c=%9`Cq}sOp?OkqcKcp1VhiS4ae1h
zh?&wo$LIRX1h*qgB63jkzGhSAq{jpM<TAH-GXQDf37%vAojO-6HAOv4XBb6sx0pnY
zg@B&!H1AqVB%x{V6mNGpgR`uKRF;Kmz2;!Fswe==wNXmRg8r>;?JcO6mzpIyWp2(x
z$4CYol#QtSJTjJ33r!}xM71_4braPjY(L(-8zNv_cmDDHSR@N$rp!+vHB^(uG8>uB
zFlwRfYN!u8c%ON@O=k@oD&^ENlNoav>6z3TN?gE#f)$h>iwoy*EsMR0B}?0GQ0~v9
zF0!qa&euiKk(z15N5K4Bw4GDSXdXrL7s$Vs;;kUu+Q_!lrdT1`^+FVfxndTu8-Q9+
zPcEmBHh_D<NFHL&OU_5jn(DR+_iu6}06{p{Bbi;3&UO0Q&Km>U&m-8A!!xV>WzOql
z5Z*wvXk}6VO|8HwW(Cg;U=nj{QD^9<Py+<?ncfOTL3=V;o~QRyOnZDrJG1@P6xi3F
zO>Anm|2PEy`^`tB%>**+2xCN9cI1X6B)8|?CT71)gh>u~ZKjJu(1haqhtTMY%Nyy!
zotoqelv`e*N(_2I!>+iA?rowc2=yV^<1#rvEp{!oF+4L|twifFITMhr*q`cig+FAT
zM|sJb6sng0SM7?3zt%7zhd`v1Xa3A8y5De{22f-E%u4#Hoj5Pc?$pQ!=BT!!tg2Kh
zr{0Hr9-BW|i!;f@ELM|BC8M6rG%MNKPN@~A*JodFss70U3xY_Ewc>=a(ASxtf+9k+
zN5fTz=qf@|OLk{6_%xRd;$e0+8%MaLiR{EN9AHPD3IpM{06W&)s|^HqG4O%$PTIWx
z_5e=U+zPhGLn}!6Be2Gy;r|{ROYz7P)!Jw>q}%s2fC2m~+iHKf;i8gV@&{GdfaGZ4
z)a~T7TmT_)<c&MD=u@tLZDWOS&OG1zI=MWNC&7KJ1JkW7&sY|1&olM~b@E5!6j-G!
z3bu}zGdM^NDuXLnXvcZqLU?)Ql*ktlebtPQY+uniMy7Acr@J>ca1sy`dP#NiAS=Jw
zB9H*B4SCfG&DxRty*3s#Yd~NmTYER+8<jPjwg-kZ`HZh`Hi1!@=d93K4>88v&er)m
za~=cMBIYWIYZ^z!-b)&KsCl&rC-zw%b(i|=s-(o8q(wG-pv4*rqG_pRv%)gp>)^Qg
zsYXU9Hiwff0@^A%?3$i|AQdO8foK^Ct|XTXk1l5dA@)IY8+rRubt}Z8u^h1UDo0tu
zJ&B>^cAw?Znd^c}@3z0K^Nkc7D&6!Q$W?C{$^4anrdVsuEo?7wnI3`<Xo|n3@%oGk
zLbz}wado+#&34E9#%+Ccd>)PAB2;hOsgWHTx7Q29ZIT0#`ZC&oQgn0L)jK?yR7BHq
z1O3T0LO-#Aw&vH+<xG8PVKk&)_OJBMUpri09!^e;Zp1WkRi5}T<wxI|V(X_n|CB^N
zx2Qz%+X9j`WHnShHm)iV8El3#!9geVGZS4K-)F`Z!Ux$(Qcs=d9*AqKcj&|?nzm7U
zR$RrsiU{d=&!DO8405M=nU$7uX*twu&3nmvJIybZ@-MX&n)U0)$xALZP;i_6WJ5-(
z*4ttr("data-categoryIds") || "";
			commodityList.requestDate("/fixed/item/getAllCategory",{userId:USERID},function(data){
				//commodityList.categoryData = data.data;		//缓存数据
				data.status == 200 && commodityList.categoryInit.call(that,commodityList.getCatetoryDate(data.data, categoryIds));
			});
		});
		$(".wqdcommodityList").each(function(){
			var that = $(this),
				USERID = that.attr("userid") || "",
				stype = $(this).attr("sorttype") || "time",
				categoryIds = that.attr("data-categoryIds") || "";
			commodityList.requestDate("/fixed/item/getItems",{userId:USERID,categoryId:categoryIds,sortType:stype},function(data){
				that.data("cacheData",data.data);	//缓存数据
				data.status == 200 && commodityList.dataInit.call(that,data.data);
			});
		});
	};
	//渲染分类
	commodityList.categoryInit = function(data){
		var html = "";
		if(data && data.length && data[0]){
			html += '<div class="categoryAll"><a href="javascript:void(0);" class="active">全部分类</a></div><ul class="categoryFirst">';
			for(var i=0; i<data.length; i++){
				html += '<li><a href="javascript:void(0);" data-category='+data[i].categoryId+'>'+data[i].name+'</a>';
				if(data[i].child && data[i].child.length){
					html += '<ul class="categorySecond">';
					for(var j=0; j<data[i].child.length; j++){
						html += '<li><a href="javascript:void(0);" data-category='+data[i].child[j].categoryId+'>'+data[i].child[j].name+'</a>';
						if(data[i].child[j].child && data[i].child[j].child.length){
							html += '<ol class="categoryThird">';
							for(var k=0; k<data[i].child[j].child.length; k++){
								html += '<li><a href="javascript:void(0);" data-category='+data[i].child[j].child[k].categoryId+'>'+data[i].child[j].child[k].name+'</a></li>';
							}
							html += '</ol>';
						}
						html += '</li>';
					}
					html += '</ul>';
				}
				html += '</li>';
			}
			html += '</ul>';
		}
		$(this).find(".modityCategory").html(html);
	};
	//渲染商品信息
	commodityList.dataInit = function(data,bool){
		var pageNum = 0,
			USERID = $(this).attr("userid") || "",
			pageId = $(this).attr("data-pageid") || "",
			modityStr = "",
			pagingStr = "",
			dataStyle = $(this).attr("data-style") || "",
			column = parseInt(commodityList.getParam(dataStyle,"modity-column") || 4),
			row = parseInt(commodityList.getParam(dataStyle,"modity-row") || 1);
		if(data && data.length && data[0]){
			pageNum = parseInt(data.length/(column*row));
			pageNum = data.length % (column*row) == 0 ? pageNum : pageNum+1;
			for(var i=0; i<data.length && i<column*row; i++){
				i % column == 0 && i != 0 && (modityStr += '</ol></li>');
				var parentStr = i % column == 0 ? '<li><ol class="list_row">' : "",
					modityCookie = commodityList.getCookie(data[i].id),
					act_class = modityCookie ? "" : "",	//现在只作展示没有选中效果，代码保留
					_blank = data[i].widowsType=="news" ? ' target="_blank"' : "",
					hrefUrl = pageId ? "pageItem_"+pageId+"_"+data[i].id+".html?catch="+USERID : "javascript:;";
					hrefUrl =  data[i].detailsType=="external" ? data[i].itemLink : hrefUrl;
				modityStr += parentStr+'<li data-modity="'+data[i].id+'"><a'+_blank+' href="'+hrefUrl+'" class="commodityWrap">';
				modityStr += '<div class="modityImg"><img src="' + CSSURLPATH+data[i].picPath.split(",")[0] +'"></div>';
				modityStr += '<div class="textMessage"><p class="moditDescribe">'+data[i].name+'</p>';
				modityStr += '<div class="modityMark clearfix"><div class="priceMark">';
				modityStr += '<div class="nowPrice commomPrice">¥<span>'+data[i].currentPrice+'</span></div>';
				modityStr += '<div class="originalPrice commomPrice">¥<span>'+data[i].originalPrice+'</span></div></div>';
				modityStr += '<div class="countMark"><div class="admireMark'+act_class+'"><svg class="admireSvg" viewBox="-250 -250 2392 2392" xmlns="http://www.w3.org/2000/svg"><path fill="#999" d="M1664 596q0-81-21.5-143t-55-98.5-81.5-59.5-94-31-98-8-112 25.5-110.5 64-86.5 72-60 61.5q-18 22-49 22t-49-22q-24-28-60-61.5t-86.5-72-110.5-64-112-25.5-98 8-94 31-81.5 59.5-55 98.5-21.5 143q0 168 187 355l581 560 580-559q188-188 188-356zm128 0q0 221-229 450l-623 600q-18 18-44 18t-44-18l-624-602q-10-8-27.5-26t-55.5-65.5-68-97.5-53.5-121-23.5-138q0-220 127-344t351-124q62 0 126.5 21.5t120 58 95.5 68.5 76 68q36-36 76-68t95.5-68.5 120-58 126.5-21.5q224 0 351 124t127 344z"></path></svg>';
				modityStr += '<span>'+data[i].favorable+'</span></div><div class="salesMark">已售出<span>'+data[i].salesVolume+'</span>件</div></div></div></div></a></li>';
			}
			modityStr += '</ol></li>';
			if(!bool){
				//分页
				pagingStr += '<a class="pagingSize hoverBtn pagingBtn firstPage" href="javascript:void(0);">首页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 74 60" enable-background="new 0 0 74 60" xml:space="preserve"><path fill="#666666" d="M40.6,26.1c-1.1,1.1-1.7,2.5-1.7,3.9c0,1.4,0.6,2.9,1.7,3.9c0,0,20.4,21.4,22.5,23.5c2.1,2,5.8,2.2,8.1,0c2.2-2.2,2.4-5.2,0-7.9L52.4,30l18.7-19.5c2.4-2.7,2.2-5.7,0-7.9c-2.2-2.2-6-2-8.1,0C61,4.6,40.6,26.1,40.6,26.1z M1.1,30c0,1.4,0.6,2.9,1.7,3.9c0,0,20.4,21.4,22.5,23.5c2.1,2,5.8,2.2,8.1,0c2.2-2.2,2.4-5.2,0-7.9L14.6,30l18.7-19.5c2.4-2.7,2.2-5.7,0-7.9c-2.2-2.2-6-2-8.1,0c-2.1,2-22.5,23.5-22.5,23.5C1.7,27.1,1.1,28.6,1.1,30z"/></svg></a>';
				pagingStr += '<a class="pagingSize hoverBtn pagingBtn prevPage" href="javascript:void(0);">上一页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 36 60" enable-background="new 0 0 36 60" xml:space="preserve"><path fill="#666666" d="M25.2,2.6c-2.1,2-22.5,23.5-22.5,23.5C1.6,27.1,1,28.6,1,30c0,1.4,0.6,2.9,1.7,3.9c0,0,20.4,21.4,22.5,23.5c2.1,2,5.8,2.2,8.1,0c2.2-2.2,2.4-5.2,0-7.9L14.5,30l18.7-19.5c2.4-2.7,2.2-5.7,0-7.9C31,0.4,27.3,0.5,25.2,2.6z"/></svg></a>';
				pagingStr += '<ol class="pagingSize pagingList" pagenum="'+pageNum+'">';
				for(var k=1; k<=pageNum && k<=7; k++){
					var num = k;
					if(k==6){
						num = pageNum > 7 ? "..." : 6; 
					}else if(k==7){
						num = pageNum;
					}
					pagingStr += '<li class="hoverBtn">'+num+'</li>';
				}
				pagingStr += '</ol><a class="pagingSize hoverBtn pagingBtn nextPage" href="javascript:void(0);">下一页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 34 58" enable-background="new 0 0 34 58" xml:space="preserve"><path fill="#666666" d="M10.2,54.8c2-1.9,21.3-22.2,21.3-22.2c1-0.9,1.6-2.4,1.6-3.7s-0.6-2.7-1.6-3.7c0,0-19.3-20.2-21.3-22.2c-2-1.9-5.5-2.1-7.7,0c-2.1,2.1-2.3,4.9,0,7.5L20.3,29L2.7,47.4c-2.3,2.5-2.1,5.4,0,7.5S8.2,56.8,10.2,54.8z"/></svg></a>';
				pagingStr += '<a class="pagingSize hoverBtn pagingBtn lastPage" href="javascript:void(0);">末页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 74 60" enable-background="new 0 0 74 60" xml:space="preserve"><path fill="#666666" d="M10.9,2.6c-2.1-2-5.8-2.2-8.1,0c-2.2,2.2-2.4,5.2,0,7.9L21.6,30L2.9,49.5c-2.4,2.7-2.2,5.7,0,7.9c2.2,2.2,6,2,8.1,0c2.1-2,22.5-23.5,22.5-23.5c1.1-1.1,1.7-2.5,1.7-3.9c0-1.4-0.6-2.9-1.7-3.9C33.4,26.1,13,4.6,10.9,2.6zM71.2,26.1c0,0-20.4-21.4-22.5-23.5c-2.1-2-5.8-2.2-8.1,0c-2.2,2.2-2.4,5.2,0,7.9L59.4,30L40.6,49.5c-2.4,2.7-2.2,5.7,0,7.9c2.2,2.2,6,2,8.1,0c2.1-2,22.5-23.5,22.5-23.5c1.1-1.1,1.7-2.5,1.7-3.9C72.9,28.6,72.3,27.1,71.2,26.1z"/></svg></a>';
			}
				
		}else{
			modityStr = '<p class="nomodityHint"><strong>该分类暂无商品信息！</strong></p>';
		}
		$(this).find(".commodityList").html(modityStr);
		!bool && $(this).find(".pagingWrap").html(pagingStr).find(".pagingList li:first-child").addClass("active");
		
		commodityList.updateboxHeight($(this));
	};
	//提取参数
	commodityList.getParam = function (objString,name) {
		if(!objString || !name) return "";
		var paramVal = "",
			paramObj = {};
        $.each(objString.split(";"),function (i,_) {
            if(!_) return true;
            var key = _.split(":");
            paramObj[key[0]] = key[1];
        });
        paramVal = paramObj[name] || "";
        return paramVal;
    };
    //更新图片容器宽度
    commodityList.updateboxHeight = function (dom) {
    	var scale = 3/4, 
    		width = dom.find(".commodityWrap .modityImg").width(),
    		height = width*scale;
    	dom.find(".commodityWrap .modityImg").height(height);
    };
    //根据分类id提取相应的数据
    commodityList.getCatetoryDate = function(dataArr,categoryIds){
    	var newArr = [];
    	if(categoryIds){
			categoryIds = categoryIds.split(",");
			$.map(dataArr,function(_i){
				for(var k=0; k<categoryIds.length; k++){
					if(_i.categoryId==categoryIds[k]){
						newArr.push(_i);
						break;
					}
				}	
			});
			return newArr;
		}else{
			return dataArr;
		}
    };
    //保存cookie
    commodityList.setCookie = function(key, value, expireDays){
        var date=new Date();
        expireDays = expireDays || 7;
        date.setTime(date.getTime()+expireDays*24*3600*1000);
        document.cookie = key + "=" + escape(value)+";expires="+date.toGMTString()+";path=/";
    }
    //获取cookie
    commodityList.getCookie = function(name){
        var strCookie=document.cookie,
            arrCookie=strCookie.split(";");

        for(var i=0;i<arrCookie.length;i++){
            var arr=arrCookie[i].split("=");
            arr[0] = arr[0].replace(/\s/,"");
            if(arr[0]==name) {
                return arr[1];
            }
        }
        return "";
    }
	commodityList.init();
	/* 设置 高级搜索 auth:lx */
	var advSearch = {};

	advSearch.commonInit = function ($obj) {
		// 设定点击其他区域关闭 隐藏盒子
		$(document).off('click.close-this').on('click.close-this', function (e) {
			if($(e.target).parents('.last-nav').length) {
				return;
			}
			if($(e.target).parents('.switch').length) {
				return;
			}
			if(!$(e.target).parents('.wqdcommodityAdvanceSearch').length) {
				$obj.hide();
				$(document).off('click.close-this');
			}
		});
	};
	
	/**
	 * @author Lx
	 * 初始化搜索框
	 * @param {[obj]} 当前高级搜索对象
	 * @param {[Obeject]} data 传入点击之前的对象
	 */
	advSearch.init = function ($obj,data) {
		advSearch.commonInit($obj)
		// 清空容器  并为容器设置样式
		// 清空初始位置信息
		$obj.css({
			'left':'0',
			'top':'0'
		})
		$obj.find('.pc-container-box .pc-nav-bar .first').attr('data-categoryid',data.firstId);
		$obj.find('.pc-container-box .pc-nav-bar .first').text(data.firstVal)
		$obj.find('.pc-container-box .pc-nav-bar .second').attr('data-categoryid',data.secondId);
		$obj.find('.pc-container-box .pc-nav-bar .second').text(data.secondVal)
		$obj.find('.pc-container-box .need2show').hide();
		$obj.find('.pc-container-box .last-nav').length && $obj.find('.pc-container-box .last-nav').remove();
	}
	/* 加载数据 */
	/**
	 * @param {[string]}  categoryId  传入点击的当前对象的分类id值
	 * @param {[Object]}  $_obj  传入区域对象
	 * @param {[string]}  markId 当前对象组的markId值
	 */
	advSearch.loadSearch = function (categoryId, $_obj, markId) {
		var self = this;
		var markId = markId;
		var str='';
		/* ajax请求 */
 		$.ajax({
			url : '/fixed/item/getItemSearchCriteria',
			type: 'GET',
			data: {
				userId:  $('.wqdcommodityList[wqdmark="'+markId+'"]').attr('userid'),
				categoryId: categoryId
			},
			beforeSend: function (xhr) {
				xhr.withCredentials = true;
				xhr.setRequestHeader("Content-Type", "application/json");
			},
			success : function (data, status) {
				if(status == 'success') {
					var str = '';
					/* 判断数据是否为空  如为空 这返回 */
					if(!data.data.itemProperty.length) {
						return false;
					}
					$.each(data.data.itemProperty, function (i, _) {
						str += ['<div class="type-item" data-flag="'+i+'">',
							'<div class="type-name">'+_.name+'</div>',
							'<div class="type-content">',
							getStr(_.values),
							'</div>',
							'<div class="operation">展开',
								'<i class="switch"></i>',
								'<svg class="icon" viewBox=" 0 0 1026 1024 " style="width:10px;height:10px;">',
									'<path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z "></path>',
								'</svg>',
							'</div>',
						'</div>',].join('');
					});
					/* 拼出属性值 */
					function getStr(arr) {
						var strHtml = '';
						for(var i = 0; i< arr.length; i++) {
							strHtml += '<span data-valid="'+arr[i].id+'">'+arr[i].name+'</span>'
						}
						return strHtml;
					}
					// 插入字符串 并显示 高级搜索
					$_obj.find('.type-box').empty().append(str);
					// 插入折叠和展开按钮
					$_obj.find('.pc-container-box').css('position','relative')
					$_obj.find('.pc-container-box').find('.more-choose').length && $_obj.find('.pc-container-box').find('.more-choose').remove();
					$_obj.find('.type-box-group').after('<div class="more-choose">折叠<i class="switch"> <svg class="icon" viewBox="0 0 1026 1024" style="width:12px;height:12px;"> <path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z" /> </svg> </i> </div></div>');
					// 为高级搜索设置最小默认高度 超出部分隐藏 并有滚动条
					$_obj.css({
						'top': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').offset().top - $_obj.parent().offset().top + $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').height() + 'px',
						'left': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').css('left'),
						'height':4*41 + $_obj.find('.more-choose').height() + 35 + $_obj.find('.type-item').length*1 +6+'px',
					});
					// $_obj.parents('.wqdelementEditBox, .wqdelementEdit .wqdelementContent')
					$_obj.find('.type-item:last').css('border-bottom-style','solid');
					$_obj.show();
					$_obj.find('.type-box-group').show();
					$_obj.find('.nano').nanoScroller({alwaysVisible:true});
					// 绑定事件，并传入必要的参数
					self.bindEvent($_obj, data.data.categoryId, markId);
				}
			}
		});
	}

	/**
	 * 为加载后的搜索条件绑定事件
	 * @param {[Object]} $obj 传入当前高级搜索区域  对象 
	 * @param {[string]} categoryId 传入当前二级分类的分类id
	 * @param {[string]}  markId 当前对象组的markId值
	 */
	advSearch.bindEvent = function ($obj, categoryId, markId) {
		/* 点击 展开 隐藏 */
		$obj.off('click.operation').on('click.operation', '.operation', function () {
			if($(this).hasClass('on')) {
				$(this).removeClass('on')
				$(this).prev().css('overflow','hidden'); 
				$(this).siblings('.type-name').css('height','41px');
				// 图标翻转
				$(this).find('.icon').css({
					'transform':'rotate(0deg)',
					'-ms-transform':'rotate(0deg)', 	/* IE 9 */
					'-moz-transform':'rotate(0deg)', 	/* Firefox */
					'-webkit-transform':'rotate(0deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(0deg)', 	/* Opera */
				});
			} else {
				$(this).addClass('on')
				$(this).prev().css('overflow','visible'); 
				$(this).siblings('.type-name').css('height',Math.floor($(this).parents('.type-item').height() / 40)*41 + 'px');
				// 图标翻转
				$(this).find('.icon').css({
					'transform':'rotate(180deg)',
					'-ms-transform':'rotate(180deg)', 	/* IE 9 */
					'-moz-transform':'rotate(180deg)', 	/* Firefox */
					'-webkit-transform':'rotate(180deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(180deg)', 	/* Opera */
				})
			}
		});
		/* 点击关闭按钮  关闭整个浮层 */
		$obj.off('click.closeAll').on('click.closeAll', '.pc-nav-bar .closeAll', function () {
			$obj.hide();
		});
		/* 点击折叠按钮  */
		$obj.off('click.more-choose').on('click.more-choose', '.pc-container-box .more-choose', function () {
			if($(this).hasClass('on')) {
				$(this).removeClass('on')
				// 由于滚动条给type-box-group加了一个高度  所以清空  之后再加上
				$obj.find('.type-box-group').show();
				$(this).html('折叠<i class="switch"> <svg class="icon" viewBox="0 0 1026 1024" style="width:12px;height:12px;"> <path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z"></path> </svg> </i>');
				// 图标翻转
				$(this).find('.switch').css({
					'transform':'rotate(180deg)',
					'-ms-transform':'rotate(180deg)', 	/* IE 9 */
					'-moz-transform':'rotate(180deg)', 	/* Firefox */
					'-webkit-transform':'rotate(180deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(180deg)', 	/* Opera */
				});
			} else {
				$(this).addClass('on');
				$obj.find('.type-box-group').hide();
				$(this).html('展开<i class="switch"> <svg class="icon" viewBox="0 0 1026 1024" style="width:12px;height:12px;"> <path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z"></path> </svg> </i>');
				// 图标翻转
				$(this).find('.switch').css({
					'transform':'rotate(0deg)',
					'-ms-transform':'rotate(0deg)', 	/* IE 9 */
					'-moz-transform':'rotate(0deg)', 	/* Firefox */
					'-webkit-transform':'rotate(0deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(0deg)', 	/* Opera */
				});
			}
		});
		/* 点击 对应的筛选条件 */
		$obj.off('click.choice').on('click.choice', '.type-content span', function () {
			// 获取属性名/值  或  规格名/值
			var attr = $(this).parent().siblings('.type-name').text();
			var val = $(this).text();
			// 插入头部
			$obj.find('.pc-nav-bar').append('<span data-id="'+$(this).data('valid')+'" data-flag="'+$(this).parents('.type-item').data('flag')+'" class="last-nav">'+attr + '/' + val+'<i class="icon-close"> <svg class="icon" viewBox="0 0 1024 1024" style="width:12px;height:12px;" fill="#e31436"> <path d="M971.292568 77.731362 945.967786 52.40658 511.698125 486.676242 77.429487 52.40658 52.104705 77.731362 486.373343 512.001023 52.104705 946.269661 77.429487 971.594443 511.698125 537.325805 945.967786 971.594443 971.292568 946.269661 537.022906 512.001023Z"></path> </svg> </i> </span>')
			$obj.find('.pc-nav-bar .need2show').show();
			// advSearch.renderShopList($(this).data('categoryId'))
			// 隐藏已被选择的选项并加载商品信息
			$(this).parents('.type-item').hide();
			// 获取已选的搜索条件id
			var idArr = [];
			$.each($obj.find('.pc-nav-bar .last-nav'), function (i, v) {
				idArr.push($(v).data('id'));
			});
			// 渲染商品列表
			advSearch.renderShopList(categoryId, idArr, markId);
			resetStyle($obj);
		});
		/* 点击导航条上面的关闭当前选筛选条件 */
		$obj.off('click.close').on('click.close', '.pc-nav-bar .last-nav svg', function () {
			// 清空当前值
			$(this).parents('.last-nav').remove();
			// 显示之前隐藏的选项
			$obj.find('.type-box .type-item[data-flag="'+$(this).parents('.last-nav').data('flag')+'"]').show();
			// 获取已选的搜索条件id
			var idArr = [];
			$.each($obj.find('.pc-nav-bar .last-nav'), function (i, v) {
				idArr.push($(v).data('id'));
			});
			/* 先执行展开操作 放置样式错乱 */
			if($obj.find('.pc-container-box .more-choose.on').length) $obj.find('.pc-container-box .more-choose').click();
			// 渲染数据/*  */
			advSearch.renderShopList(categoryId, idArr, markId);
			resetStyle($obj);
		});
		function resetStyle ($_obj) {
			// 设置高级搜索对象 始终跟随分类导航条  并与之左对齐
			$_obj.css({
				'top': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').offset().top - $_obj.parent().offset().top + $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').height() + 'px',
				'left': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').css('left'),
				'height':4*41 + 6+ $_obj.find('.more-choose').height() +  $_obj.find('.pc-nav-bar').height()+'px',
			});
			// 加入 搜索条件已被全部选完，则nav 下边框也变为实心的
			if(!$_obj.find('.type-box .type-item:visible').length) {
				$_obj.find('.type-box').css('border-top-color','transparent');
				$_obj.find('.pc-nav-bar').css({
					'border-bottom-right-radius': '3px',
					'border-bottom-left-radius': '3px',
					'border-bottom-color':'rgb(220, 220, 220)'
				})
			} else {
				$_obj.find('.type-box').css('border-top-color','rgba(220, 220, 220, 1)');
				$_obj.find('.pc-nav-bar').css({
					'border-bottom-right-radius': '0px',
					'border-bottom-left-radius': '0px',
					'border-bottom-color':'transparent'
				})
			}
			$_obj.find('.type-item:last').css('border-bottom-style','solid');
		}
	}

	/**
	 * 渲染商品列表 
	 * @param {[Object]} categoryId 传入当前二级分类的分类id
	 * @param {[Array]} idArr 传入选择的 属性或规格值id数组
	 * @param {[string]}  markId 当前对象组的markId值
	 */
	advSearch.renderShopList = function (categoryId, idArr, markId) {
		// 更新数据
		// 获取 参数
		var contactId = markId,
		modityDom = $(".wqdcommodityList[wqdmark="+contactId+"]"),
		stype = modityDom.attr("sorttype") || "time",
		USERID = modityDom.attr("userid") || "";
		// 调用commodityList.requestDate()  方法执行ajax 请求  渲染商品列表
		// categoryid = $(this).attr("data-category") || (modityDom.attr("data-categoryids") ? modityDom.attr("data-categoryids") : "");
		commodityList.requestDate("/fixed/item/getItems",{userId:USERID,categoryId:categoryId,sortType:stype,properyId:idArr.join(',')},function(data){
			// modityDom.data("cacheData",data.data);	//缓存数据
			data.status == 200 && commodityList.dataInit.call(modityDom, data.data);
		});
	}
});	
