Cxlb_s&}E3`5HHQH|*-tEB-TIm+=2l_pU*fUDtWohKflgDkb4B%SB6xFoI+Z
z*_kF72{bt%h?$;OKL*q2>6rlrjmPco+poEOZ{t4Z0Z<~qhXj%$_yR#v7Aew{DAIab
ziX@woEL&14wxdL>l#{qBQEaJHDOWjvQpu0uRH-N5TKl#3+54Qc&*>hTmLDST+`ea@
zz1RBIx1M|Y;SjPK8O>9tsw)$cn_N|rOklghbhKH~G3!we$>Z(uWW77pL-3dXgD7gy
zu?`0z%wTo-2Mjlj(b^mEz_8|6l`@Q42<zX(=ljEQ3{hz%Rtm8DxR`~gfgnoTRVgUS
zgbRC2EGzYyR8tc`D%QB_kCAmfi`y2=u)iE;8Ea^Kanz<5Lu=8<0AB{B&;S=dr`RCr
zfaa>geD-^h5-6McKBc~7Dof6HHGwu6O$!@Urx?Fj33;$e-`c-HiON3@{2PkY+9lQ@
zTf9u|;IREIlt2_#%9;buBDrwwz*7eXcVcL+=I0gEnD<3>d`N9I82XMx6gWd@<C82)
zR?fi|PyBe;I=H9-hq6~BKr3PZzRML3XRNMe5&;@(p>uR%j)jYVKVNLa$WX8NU{kMI
zbQWJVaf10n9F#61Rkp8^nW`lgTm8LM><LD2Q_ZfTOco<b!$@N5!h+vUAeKc#t1-=#
zI<=`ulUh(7xdX&pvL+tAW=n?cTI;miU~Gmm$F3{izL=ACSX7URn_aR6UduZfdnf1f
zeo9Mi7&W!=tU+2OT{?Rk5=}l|h#;jNUaU6K$Xbzw<~x=`JLjgP19-kt5xI8ZCId;O
z`6~*&q(&<wMJtRnm6Uq;$eqS08ub$tpl2+JI51NaFD*K{#j+x>koUwmf49}AYz>no
z3HjoiA9g7w(CB<>tjx0NX}jq?woEC}Lry$PBNO4KUQ`ypomM-+=q;@-y!QsxEFM+i
zkQR^lFbY1JIe~fg;U0yRY>e8$XQ}v!Q#K->eGwD~6s(&g{baou5cy57<#m=hUWa^V
z84U{6QHFtTz;CeQcjMiz=rxQtIgYJ7WJ<H&5kB7rSunWmo1L|_?r8MD+u#0n^4j^0
zFPhe2zEu7Gax6;WcJu?s^(Hw#rlf0BTH)!NZ=bsP(DYxt{AyZ9#CKtZpHU}tl!$nk
ztAZ_$-Y9wMbbtJ2cZi=kr+z2Qlvy;e0&h{FO7LTWNZElTN~R1j$s~8fW|`lYs1M2=
zVuj?ytBgO9f-KC69^fBJlm2Jsl`pN@7H|m}jRFGZ!A@S1^nJRd4Fl@?$-)HfrQC!M
z^eHol;@3u?nn#b2Vc4)JS4$q^<4EC~CgcS`bHw8PBVDcSP_-2)Pd!(x&OuxO*&V=P
zEah(u_i(j%qkB)p6O8N~iW*V0YvdcnYRvDV`dRC?nu!1w0WxSU4?0TWV?oWGlWHW1
zmMBVoYL~d<OOFm{JQ!;<T`FX1C0klhzvWci0%Z2K#K)S&pS-%oKfvmjU&GTOhz#1O
zHBM#dh9j4}9DU6?b1E<T^e@La@r?Ve=3J+Bw#%U->Lda|=d|-bo^k+^vEF#EQo0NW
zn>q{3BaW*7*F|;Z2nr!u6<AJ$<hv=Dt7{ZxS6X=h7ws+Y4nsQOJ7@G$-d3;si$t<@
zg6Gp^00p}=1`JK`Dj@Q;Nbxb&TRlk<Ho+>de$Ax@Mv^9+Rxa3UMa`m~R6B=77v%O3
zh@}|{=t1AsFN7N)>53(MRYZ@eg7-De!IZ{^pHd&ub(5)Xv<j7ql{o$+#ngO}X6Z)!
z_egkh6Pn$KrdtrNBq<i2l9w=l`U0#XZhlNtJqD<hB>6uCeZPc(kvz=Z5#Tm%Wc*HY
zcVqu5++FKdLCmfUCw;A2aYCPSpjER1VQT2o?nsPnvSfc-JztCrG_YfF$DG&LVi*R4
zq+l_TH>PbBkmxqI)H_5BLhhYoie%oZOCuK4Q#SOIql)pFrO0A2lKi}xcgOoy;VY$n
zOFYrBrjqCq>MyO)mb;f>zp;Ogaxl8-M|rj(Y1y2*;l}^8@GfR+HP`qWJV3&hd}9)d
z^ETGKx6%APgYrfvD1|q5E(N&N^ZGI}poY%DQ2gD(Si$lpBM3Sdlfo2B&w(h*>JzJc
z9c$3NR3R!tEQ~!!8_MAKj!%o3YN-_k-^Q{YRZneTqQDlh*n9KZCtXV8pv`ovVpdWM
zu}o~JmP2>LpOe2u5#pDItdVU!I%hGrr<=&HsRdVq1kThBjR3brmi@`1wk+lIFGd9x
zl<M>+V}?~Gic!>e5F<u$3M=zaZ_lhW5KENbBnDkEvU6AdKD6|DcQ`&PXA;0YS{~4~
zZ6}7q4)T*oeQ3a_eU_F6;e91RD|i@UGf_B6+q&;DK|prd%m|M=NXnuu>r{8NhM^8L
zP6qmg-_tWMxVgS0s(4Hnq#T3uR1PivJIBHwg;Kv&eTgb7d1i&UyrY0+6}FZSBDo<J
z(ImNIQ_{+dxEzd$HO8}CJW>`61faxN-d1~VM688#X-(`PmHHwwG2EI3hD(9;$-8-(
z;^_CEQn(XIj}e5Pi)U8ghbg*>od9AuxT<by)E#bjdfP8{*DrT^lWxcrwS_>?^tO7<
zqd{hVCkDopZ!f-Oae(7Hrr5zLEOS0)6VApWPxuUwPvb0@UpwSWai<~=>j}TemcBN$
zvGED$-z?eiBkEJxDbSqvCe>@63-#=V<?tdGX3VKi8vP2zKi@o%!sQwVivl^x{U_BY
zn}>0+FKyOC`ZH<}rllJ*jfax$1qt0STrKUb_+u(4NEcGn>)zCvCx;pN2gO3u;;gc)
z_(picTS$nitVju7n=B$%TX?h}`2m0}sIAUqyv3HhKp0CO6>q=v70rnhYXu!-?yGm>
z$S)3-(SkUb@K{e@NMB;2wO!^56z@LhXU+30ZQnXvYtWMYHEdW&YRk&Wc+Z5M-&Skm
zTYKC-X`Xn%ox;OQ(Qe0H#n#%mq|T=Fi7*}4Q(PtoN@KCe`6Qy(yEi)HH5Nz<qd5;x
zS*!T*r6Im6>et;hJ-NIs{`ur0ngV)L0R0K@R$b=og8pvATrDjp<5wN^Hx5D^jwg|I
z-og+pNYB&I^ea<ZD_K}nIqSj8fyrrgQuvOUzKF}z1l3%3)Tg%a78ra6gV0>DV`+##
zk*dh{n;Birok^(qp7lj7ZFQl@+}<yodu?GdqFV7A#h=J`bi}p75Wjy-I|krT)Il}7
zOJiKfeY5o}6?}5G`tjBh(FGq<eKe@fu9xEMSKa*Lh5}s1k$imH_-^dVz=1B#)h2z<
zpY4hP9oL}nTb<FC_w@Av<~vx1+A;O!Wz~3CcjwgrR}%28#SOQo5C*kJLNCojR#L@W
zLc5<BL?a6<rZq9T9C#9dHKhvUN36={s8=j>Zu|#tCL~$9>*keh5U0Q<P-5{E(IL8R
zK~$2agr0tU+FTCH@geieN0*nX(hc9Qz;x}zsRO8bQ^o$!-f*zi?XFWp^kQd>nVEgx
zU*pC#l%HbCZtAl?p0cx-r`LF%6yn?FS$>@G{_}cv>1Nl4XI!nUm8SA2h$f9XbXi6b
zogMr+TXa&q=EXhGSeClyX(99Sl-iB3G`FM~q9AXGSiBLp`DvwY<p1P*KLrKgHz}Vp
z^CSkC*$W%mGqL>DSwGrP;+oYhs%MfuehzLFvd)?Sq(@L+Rbw3mncvp821tZA2;A(#
zIH|qnK*~I{{T=m^Y2((jD2>RLt12532}yxF?wO8kRwVZiH4wXdp-HAMb1~wUa6?Q5
zmwxeV2qSKra)}FM#5{3Mohb~P5Ra=2B+|{gMta1&)nBw;e707_b|r;#_as1sM6rmf
z(RPP;l_lQ1-SPa2s`T_Fo<nqR5@E<+T<ZG)O<@MS-u}Qff$L+&G)=kRS)bYJV5muN
zB-q5P`c-OD*7D-Z{WDC9KzUu0CS<_WE1)@(F{zL*GEKCU^5|0fcIE1c^>xm2;C?x6
zthk^;-$XQWSzqC^J&Y;`PC|BQpfyoIj6fewzv(aQ%cb_8RX=C@P!ae2PT;h+B0fG`
z3)YWrk52FIjr{~B%3YlUcgAkVp(Z9+({!+_gF&y`=_9vuM7>CRT&x4B00eP_mY|7a
zW~Lo~MW=Hd6w*q}Y<iTV-12wbHHYH(S<)1EY)&K;92Wnw83@P;zk7Vxp7KOi#a`w@
z+f;k>Uy~V-+%+4=D5Y?POdKz>c$mDKc9mfnXzhC63oqc*Nz%vA?o=rwb2|=go1?m|
zUZ81OCvTnU4LU8m2~J7*kVR7o39&U(h*7-e<M{domKtQm^XZxmDOh)^dS8(fKj+w_
z#p4D%MkA?!`YH9QP8v|tpJ-Rf`AyTUQc*}}@OxT6qD0F5V*yX+)cfMQin6SADK1nh
zpa`HcM#0y`Dz2!<)>khgS9)OaeWlQh+$01XzfqDud05flmuBEsyvG>OAuB``{u{B*
z{PCj~1@Y4P4403}cvj^E!uQz8dRiefelC*tJL<ePx2IhQ!TwCC$ftH4;YaU|V-oVB
zZDFtdwfI!ao7tz-yJ-}Vo;ue|7L5lF@3_K)&vrfHMK_=9=G_#bX<hXYaQ5-ZE)DUd
zH{>qAZ+)d`5a~}u(ro_+)FtkdZ6aIR7~+0p_B5lJv4AHR_PFToKBOFC5&4UY+ab$<
z)n#Nu{~D5l+T!hIhnX@8%P7woVa6qf5pvze7bHK>2de|9ji_Bp*7e~tjFu1t4*R3;
zW#TW`V^hutO@9MSy{0xu62D_(pMPEx2MQ|ZvZYwc;rH|27o3#>cj8Ea;Yz#}NbFJ{
zXBMv;2*2ZElNd<6T1j+Fhj%e1;)=G<s5uCXv;8?HHu1n>DdDsDO*3{VWPM+LImK|N
zAAI^`P;RR&7zNW4<jirx9U$Vy_9kpKoo)-nO}+_xpmZs@f40GcDfJ6@FFmU)SF=)L
zbCPG3#Sbr6Ixkt%gFU_nU><uj8m{4grOVc!XJ_C(>+6oP?IglV+Q)X=?x66KrX~BK
zd)Jbk+AGmjP5!^=!PYB7qxG-Ca#&3yf7YsbD%YSP`jO>#i`_RW^5}y}9X~nQ?yYx+
zkD&K~>NZnrv=7(cnVx=A(l8veUjqm}feEmz<A#1fd~*fL(>&vamrG3&s)eIL`Zb~p
zH;BR{fcktgaG0F}PsI;Ut2uX#Znji%tuil`ZaAa6&4lN2N1a_8>_Ta~%L6)nP9BsW
zz05P2gFiYuJ^dH2U<<eoXa6`)%;KU~AM@hVsj#3WeG#<i^1?<3WY5`q8O>u#DX5Uz
zFa{$40?(xF;q#O}^bxhLFJd}KeidDIUH~;pdp;+hHjns{lyIC(-OIHX<fH(@cYnzy
zceQf0ssyO1VKv84w6FSOXnGfe9%TV_YK*d8on>jIhfn@j^O8;y!Lsz8*Ln7LQ8af3
zSn8|RL@67ukyW2B47@)Hagv#@sGm#SxM#sRr(3-SZHtnK(8-{;PVb8wFO3#3T$d;1
zmer2ESt&e(Qa4yUG@*f38X_HZ@^DT4M$s`2MIsYk<8?Im#8@=)CLf`G?lFkQX?=G#
zc`XKKE9Af<kbC>%>JyF2(X_i(ZFt3QFevG;bEA6Q4_OS(m(b?&nJ1Nt=r|zOLFSAD
zMV2`jE;9W+e_6((#YR}`7Jp>Soj)Jv4J@fG>V0-+bXc4kOqGPqUkKzFwXDiqBDc_1
ztmK(+qj0WyG_-?>D;1@UI--6`LR4!65Ibzv6I;m$nf&f+8UVuny6rn($_+86o?OXL
z<3Gp?IOCSLpMw57R@54$!jm%F#m+Jh4!DqaeeDbef{|a3R!GQ83n@)aP8QikTUrht
z<s|hJ%>xPCZJc`^61bWK4qn=Vv&I>$)&gwAHR&&yBhrZKh-DbjdCe#C^3k)bz|ex7
ztTmH+<6P4k+rFsIRa~<PE}xfy((liqwf6-~uBGI~8W?|KoNzI6$4TL9JT@HuqV}FL
z^)Q%@T%M7SVT({(=G&bBNE|(_J_i45)YV%>R!ey8jc`0|QN^#JV-z>;q)uLZ35WH=
z>SJQ4j#i9T^k1q5ZCrd<@h28iJ-x<XvM&&EKWFaT=z<2!Gk$XXiCjNOeq#NGD~YR~
z{JPmKfMxn@aChFl(eXlH!r$eWI&BLQ*wsaKiy`5{21y>r)~5gJ<$qA>My2*Bh0!`n
zH%*s@m&qJ|1=4m(eR=2`HS@RU0Q2!nS~+X?YKyrY&pm61AjvX6#s}XOS0pv4>JIV|
znQ#>!QN!4Pv==q`h#7UwPb*`fXoOg<M7qE{1$IZ9a-<LwprW(`KvcY2@h5TlTKt_D
zwzT?p)vW1dXc=aIny26gdD7oo6@9!*?dfh(E>hZT0mA@blIj?#p?%00Z8@g~(tEHO
zeXUiJisj@~D6$h<-(+YFZQ;)jyW`2Qe{wju*6riX29x0$_w7mjs+*HaV!6UnYdu9|
zaX1cYBJ1x}Pw3~!C-93M_@`IZS(jNogsabYJT-5w!6h}lf`TU$cvDkBGT&_v+<8JQ
zi)5S2D@y0p8-6l>C~4WsliT$iEGJVJo>Z@H^}2m+fcu@{t^8HBX${Xvu%A<Z7(_Dc
zrsW#v7#`zK(rmSWG^}CXiHag23|3VU%4Jb7?h0vgFeP3vSJg167=PlZD)xs-;Hof$
z8n047OJ!Wx0zWv7<p~7%fc;?$Y7qelt!#XlCnvpYOWnO57s2|NbzJ_sW6CmYQiK*{
zicryX{jt675bTyKVfC+n7s&2=^f*)J=Gh2GsdK=iMZ#jFJL)<b>UfBEv%Xn4i>ZUf
zc$iE5?Xj)G*8JR!@}9yKx8oo!_aQtzt^vpqTodtS1I5y#%S}oa72Y)DtKQ@>&#6z@
zy>N)#;F!y$J*Difz&)!H=o~81Caa_IuwY9nlZ~Krx;Z0^aEdmKPXw_Fkz#P~Z!Bf0
zNYP6>Qo_f;{$uJCQVm-!Qo!fHOcFg>XKcD9wwje_lgcG8s1I`qJG8{2yF{-XNsA#e
z{v?-{T~a&LXU$=uR-uOY(eWpU42Agpsor)UBYnoxPRI2gWUQb>&-KY@#Cc$0_Tut$
zix)1=F3(<g{J0PZ;qD|^D(2x`v`sL`^&N8Y+^^9_Td%1?aN-SY_esDJjWOq-HAfz%
z`ZsUhoI-N_<`loOH8iwG?vfLvqyLv;=8t408;07gJd2}v?e<QAqb$}fWW_HhDsyTi
zh>A_+G*olPiG_IS5Q8ZEi0Jr&+JQUiYS^R`)JQgBO~<nxj`3-di-?%hjQSmvH|R;V
z21gsjo8ps9pOU0fwXoZu)&7XO;v_M&4DB!zr&ffe&$|bZjOUVW<V*4@EuFxU%LD<9
zWTZw|7u7fPOgBUfa~GF;Y6VKbOD)#RO64*#R=eW&vA}VNlRT_?^Ia=c>~A)Z8{B?G
zDqg4`sw66<K|@U+)3uA>315Uli$cpPHBM;;2WF4QCzcEsdCcPgP;P}K0KHE`zFd}m
zzI!W%yBv-3o8*N>#{x>m0<OlrF~(}=nEja4r5?tNZ66KWx@b&vOt(o@1O`-ZGwCdx
zhMQDmlmyvpY70`(`u5Vs1;t0y-w$WDoZsFY;=)xuv&Fo%MT@F2?6a}prFF3Y6>Rhz
zG-P=XZ&lCxAsDgrRp^Zuy3p2^sN{mWK8Qw^oLIl!>92Lyvngk4V~XmRrjvKo9$Jy@
zhB=+HA7oU<q;SIi`6F*dZSQ5|6)}|zblUr|`%CJt1;e(dUst^rzh}~=HcHF$JqlDi
z@e6*VjEv+9m5FS#oxHKt9d@Vowy$G&P<}4`0)U@x!iD_-GSI#7WYea<uSq4+)#(B4
ztZPEP`)#%A!<sFnH=qLaf<l1l-;Obmp|o*OsAfJSp*3ewQ2;uEv*Lpkw1Wtx=<&T)
z{wnk|DLD86|BEEKYlFcM!-47IS6{R8BkGTBbCh+Ea|Jjk7-057HbM(!Xr%Im(4-ka
z*L>&IXo|1N!J2FM&$7DiuK1~A+~ro@FFn>Ttjk^5!!8C(54}4wyhqf#Xf)LfhHX*t
zW3c~~5l5~mzx$)=&jgCJc2JVCa9|MexZ(|S5+rz6LO1AN*jwxmpiM%mYAY;UY%RGJ
z+`2PbNe_<@C$8T!X=qTey(y;x#Hf_T=xj2N1r7*QncLZjEvtTPrl2@N7h3WZsX{`2
zUJMp&qe(oDUW07U4z+oF&kYhGd=s0NF^~kyzijUt(7$W46SL~99Y|^e;0?TN{HSrQ
zT=CRi5EL!Wf@v~mE>&!;Sv2LQJbY;5Gq3({cM(S2mJ2a8re!uM>l7SV><l}*n2S>S
z1=yF;L`?jk_!H+`YcJ7FTX}O5u6?|M5%ak%w#H5#no4u1JLW8lTYFl~rex2`OL=s=
zRO;?1liWRd>k#HMg)iYDhmDttr("data-categoryIds") || "";
			commodityList.requestDate("/fixed/item/getAllCategory",{userId:USERID},function(data){
				//commodityList.categoryData = data.data;		//缓存数据
				data.status == 200 && commodityList.categoryInit.call(that,commodityList.getCatetoryDate(data.data, categoryIds));
			});
		});
		$(".wqdcommodityList").each(function(){
			var that = $(this),
				USERID = that.attr("userid") || "",
				stype = $(this).attr("sorttype") || "time",
				categoryIds = that.attr("data-categoryIds") || "";
			commodityList.requestDate("/fixed/item/getItems",{userId:USERID,categoryId:categoryIds,sortType:stype},function(data){
				that.data("cacheData",data.data);	//缓存数据
				data.status == 200 && commodityList.dataInit.call(that,data.data);
			});
		});
	};
	//渲染分类
	commodityList.categoryInit = function(data){
		var html = "";
		if(data && data.length && data[0]){
			html += '<div class="categoryAll"><a href="javascript:void(0);" class="active">全部分类</a></div><ul class="categoryFirst">';
			for(var i=0; i<data.length; i++){
				html += '<li><a href="javascript:void(0);" data-category='+data[i].categoryId+'>'+data[i].name+'</a>';
				if(data[i].child && data[i].child.length){
					html += '<ul class="categorySecond">';
					for(var j=0; j<data[i].child.length; j++){
						html += '<li><a href="javascript:void(0);" data-category='+data[i].child[j].categoryId+'>'+data[i].child[j].name+'</a>';
						if(data[i].child[j].child && data[i].child[j].child.length){
							html += '<ol class="categoryThird">';
							for(var k=0; k<data[i].child[j].child.length; k++){
								html += '<li><a href="javascript:void(0);" data-category='+data[i].child[j].child[k].categoryId+'>'+data[i].child[j].child[k].name+'</a></li>';
							}
							html += '</ol>';
						}
						html += '</li>';
					}
					html += '</ul>';
				}
				html += '</li>';
			}
			html += '</ul>';
		}
		$(this).find(".modityCategory").html(html);
	};
	//渲染商品信息
	commodityList.dataInit = function(data,bool){
		var pageNum = 0,
			USERID = $(this).attr("userid") || "",
			pageId = $(this).attr("data-pageid") || "",
			modityStr = "",
			pagingStr = "",
			dataStyle = $(this).attr("data-style") || "",
			column = parseInt(commodityList.getParam(dataStyle,"modity-column") || 4),
			row = parseInt(commodityList.getParam(dataStyle,"modity-row") || 1);
		if(data && data.length && data[0]){
			pageNum = parseInt(data.length/(column*row));
			pageNum = data.length % (column*row) == 0 ? pageNum : pageNum+1;
			for(var i=0; i<data.length && i<column*row; i++){
				i % column == 0 && i != 0 && (modityStr += '</ol></li>');
				var parentStr = i % column == 0 ? '<li><ol class="list_row">' : "",
					modityCookie = commodityList.getCookie(data[i].id),
					act_class = modityCookie ? "" : "",	//现在只作展示没有选中效果，代码保留
					_blank = data[i].widowsType=="news" ? ' target="_blank"' : "",
					hrefUrl = pageId ? "pageItem_"+pageId+"_"+data[i].id+".html?catch="+USERID : "javascript:;";
					hrefUrl =  data[i].detailsType=="external" ? data[i].itemLink : hrefUrl;
				modityStr += parentStr+'<li data-modity="'+data[i].id+'"><a'+_blank+' href="'+hrefUrl+'" class="commodityWrap">';
				modityStr += '<div class="modityImg"><img src="' + CSSURLPATH+data[i].picPath.split(",")[0] +'"></div>';
				modityStr += '<div class="textMessage"><p class="moditDescribe">'+data[i].name+'</p>';
				modityStr += '<div class="modityMark clearfix"><div class="priceMark">';
				modityStr += '<div class="nowPrice commomPrice">¥<span>'+data[i].currentPrice+'</span></div>';
				modityStr += '<div class="originalPrice commomPrice">¥<span>'+data[i].originalPrice+'</span></div></div>';
				modityStr += '<div class="countMark"><div class="admireMark'+act_class+'"><svg class="admireSvg" viewBox="-250 -250 2392 2392" xmlns="http://www.w3.org/2000/svg"><path fill="#999" d="M1664 596q0-81-21.5-143t-55-98.5-81.5-59.5-94-31-98-8-112 25.5-110.5 64-86.5 72-60 61.5q-18 22-49 22t-49-22q-24-28-60-61.5t-86.5-72-110.5-64-112-25.5-98 8-94 31-81.5 59.5-55 98.5-21.5 143q0 168 187 355l581 560 580-559q188-188 188-356zm128 0q0 221-229 450l-623 600q-18 18-44 18t-44-18l-624-602q-10-8-27.5-26t-55.5-65.5-68-97.5-53.5-121-23.5-138q0-220 127-344t351-124q62 0 126.5 21.5t120 58 95.5 68.5 76 68q36-36 76-68t95.5-68.5 120-58 126.5-21.5q224 0 351 124t127 344z"></path></svg>';
				modityStr += '<span>'+data[i].favorable+'</span></div><div class="salesMark">已售出<span>'+data[i].salesVolume+'</span>件</div></div></div></div></a></li>';
			}
			modityStr += '</ol></li>';
			if(!bool){
				//分页
				pagingStr += '<a class="pagingSize hoverBtn pagingBtn firstPage" href="javascript:void(0);">首页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 74 60" enable-background="new 0 0 74 60" xml:space="preserve"><path fill="#666666" d="M40.6,26.1c-1.1,1.1-1.7,2.5-1.7,3.9c0,1.4,0.6,2.9,1.7,3.9c0,0,20.4,21.4,22.5,23.5c2.1,2,5.8,2.2,8.1,0c2.2-2.2,2.4-5.2,0-7.9L52.4,30l18.7-19.5c2.4-2.7,2.2-5.7,0-7.9c-2.2-2.2-6-2-8.1,0C61,4.6,40.6,26.1,40.6,26.1z M1.1,30c0,1.4,0.6,2.9,1.7,3.9c0,0,20.4,21.4,22.5,23.5c2.1,2,5.8,2.2,8.1,0c2.2-2.2,2.4-5.2,0-7.9L14.6,30l18.7-19.5c2.4-2.7,2.2-5.7,0-7.9c-2.2-2.2-6-2-8.1,0c-2.1,2-22.5,23.5-22.5,23.5C1.7,27.1,1.1,28.6,1.1,30z"/></svg></a>';
				pagingStr += '<a class="pagingSize hoverBtn pagingBtn prevPage" href="javascript:void(0);">上一页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 36 60" enable-background="new 0 0 36 60" xml:space="preserve"><path fill="#666666" d="M25.2,2.6c-2.1,2-22.5,23.5-22.5,23.5C1.6,27.1,1,28.6,1,30c0,1.4,0.6,2.9,1.7,3.9c0,0,20.4,21.4,22.5,23.5c2.1,2,5.8,2.2,8.1,0c2.2-2.2,2.4-5.2,0-7.9L14.5,30l18.7-19.5c2.4-2.7,2.2-5.7,0-7.9C31,0.4,27.3,0.5,25.2,2.6z"/></svg></a>';
				pagingStr += '<ol class="pagingSize pagingList" pagenum="'+pageNum+'">';
				for(var k=1; k<=pageNum && k<=7; k++){
					var num = k;
					if(k==6){
						num = pageNum > 7 ? "..." : 6; 
					}else if(k==7){
						num = pageNum;
					}
					pagingStr += '<li class="hoverBtn">'+num+'</li>';
				}
				pagingStr += '</ol><a class="pagingSize hoverBtn pagingBtn nextPage" href="javascript:void(0);">下一页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 34 58" enable-background="new 0 0 34 58" xml:space="preserve"><path fill="#666666" d="M10.2,54.8c2-1.9,21.3-22.2,21.3-22.2c1-0.9,1.6-2.4,1.6-3.7s-0.6-2.7-1.6-3.7c0,0-19.3-20.2-21.3-22.2c-2-1.9-5.5-2.1-7.7,0c-2.1,2.1-2.3,4.9,0,7.5L20.3,29L2.7,47.4c-2.3,2.5-2.1,5.4,0,7.5S8.2,56.8,10.2,54.8z"/></svg></a>';
				pagingStr += '<a class="pagingSize hoverBtn pagingBtn lastPage" href="javascript:void(0);">末页<svg class="pageSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 74 60" enable-background="new 0 0 74 60" xml:space="preserve"><path fill="#666666" d="M10.9,2.6c-2.1-2-5.8-2.2-8.1,0c-2.2,2.2-2.4,5.2,0,7.9L21.6,30L2.9,49.5c-2.4,2.7-2.2,5.7,0,7.9c2.2,2.2,6,2,8.1,0c2.1-2,22.5-23.5,22.5-23.5c1.1-1.1,1.7-2.5,1.7-3.9c0-1.4-0.6-2.9-1.7-3.9C33.4,26.1,13,4.6,10.9,2.6zM71.2,26.1c0,0-20.4-21.4-22.5-23.5c-2.1-2-5.8-2.2-8.1,0c-2.2,2.2-2.4,5.2,0,7.9L59.4,30L40.6,49.5c-2.4,2.7-2.2,5.7,0,7.9c2.2,2.2,6,2,8.1,0c2.1-2,22.5-23.5,22.5-23.5c1.1-1.1,1.7-2.5,1.7-3.9C72.9,28.6,72.3,27.1,71.2,26.1z"/></svg></a>';
			}
				
		}else{
			modityStr = '<p class="nomodityHint"><strong>该分类暂无商品信息！</strong></p>';
		}
		$(this).find(".commodityList").html(modityStr);
		!bool && $(this).find(".pagingWrap").html(pagingStr).find(".pagingList li:first-child").addClass("active");
		
		commodityList.updateboxHeight($(this));
	};
	//提取参数
	commodityList.getParam = function (objString,name) {
		if(!objString || !name) return "";
		var paramVal = "",
			paramObj = {};
        $.each(objString.split(";"),function (i,_) {
            if(!_) return true;
            var key = _.split(":");
            paramObj[key[0]] = key[1];
        });
        paramVal = paramObj[name] || "";
        return paramVal;
    };
    //更新图片容器宽度
    commodityList.updateboxHeight = function (dom) {
    	var scale = 3/4, 
    		width = dom.find(".commodityWrap .modityImg").width(),
    		height = width*scale;
    	dom.find(".commodityWrap .modityImg").height(height);
    };
    //根据分类id提取相应的数据
    commodityList.getCatetoryDate = function(dataArr,categoryIds){
    	var newArr = [];
    	if(categoryIds){
			categoryIds = categoryIds.split(",");
			$.map(dataArr,function(_i){
				for(var k=0; k<categoryIds.length; k++){
					if(_i.categoryId==categoryIds[k]){
						newArr.push(_i);
						break;
					}
				}	
			});
			return newArr;
		}else{
			return dataArr;
		}
    };
    //保存cookie
    commodityList.setCookie = function(key, value, expireDays){
        var date=new Date();
        expireDays = expireDays || 7;
        date.setTime(date.getTime()+expireDays*24*3600*1000);
        document.cookie = key + "=" + escape(value)+";expires="+date.toGMTString()+";path=/";
    }
    //获取cookie
    commodityList.getCookie = function(name){
        var strCookie=document.cookie,
            arrCookie=strCookie.split(";");

        for(var i=0;i<arrCookie.length;i++){
            var arr=arrCookie[i].split("=");
            arr[0] = arr[0].replace(/\s/,"");
            if(arr[0]==name) {
                return arr[1];
            }
        }
        return "";
    }
	commodityList.init();
	/* 设置 高级搜索 auth:lx */
	var advSearch = {};

	advSearch.commonInit = function ($obj) {
		// 设定点击其他区域关闭 隐藏盒子
		$(document).off('click.close-this').on('click.close-this', function (e) {
			if($(e.target).parents('.last-nav').length) {
				return;
			}
			if($(e.target).parents('.switch').length) {
				return;
			}
			if(!$(e.target).parents('.wqdcommodityAdvanceSearch').length) {
				$obj.hide();
				$(document).off('click.close-this');
			}
		});
	};
	
	/**
	 * @author Lx
	 * 初始化搜索框
	 * @param {[obj]} 当前高级搜索对象
	 * @param {[Obeject]} data 传入点击之前的对象
	 */
	advSearch.init = function ($obj,data) {
		advSearch.commonInit($obj)
		// 清空容器  并为容器设置样式
		// 清空初始位置信息
		$obj.css({
			'left':'0',
			'top':'0'
		})
		$obj.find('.pc-container-box .pc-nav-bar .first').attr('data-categoryid',data.firstId);
		$obj.find('.pc-container-box .pc-nav-bar .first').text(data.firstVal)
		$obj.find('.pc-container-box .pc-nav-bar .second').attr('data-categoryid',data.secondId);
		$obj.find('.pc-container-box .pc-nav-bar .second').text(data.secondVal)
		$obj.find('.pc-container-box .need2show').hide();
		$obj.find('.pc-container-box .last-nav').length && $obj.find('.pc-container-box .last-nav').remove();
	}
	/* 加载数据 */
	/**
	 * @param {[string]}  categoryId  传入点击的当前对象的分类id值
	 * @param {[Object]}  $_obj  传入区域对象
	 * @param {[string]}  markId 当前对象组的markId值
	 */
	advSearch.loadSearch = function (categoryId, $_obj, markId) {
		var self = this;
		var markId = markId;
		var str='';
		/* ajax请求 */
 		$.ajax({
			url : '/fixed/item/getItemSearchCriteria',
			type: 'GET',
			data: {
				userId:  $('.wqdcommodityList[wqdmark="'+markId+'"]').attr('userid'),
				categoryId: categoryId
			},
			beforeSend: function (xhr) {
				xhr.withCredentials = true;
				xhr.setRequestHeader("Content-Type", "application/json");
			},
			success : function (data, status) {
				if(status == 'success') {
					var str = '';
					/* 判断数据是否为空  如为空 这返回 */
					if(!data.data.itemProperty.length) {
						return false;
					}
					$.each(data.data.itemProperty, function (i, _) {
						str += ['<div class="type-item" data-flag="'+i+'">',
							'<div class="type-name">'+_.name+'</div>',
							'<div class="type-content">',
							getStr(_.values),
							'</div>',
							'<div class="operation">展开',
								'<i class="switch"></i>',
								'<svg class="icon" viewBox=" 0 0 1026 1024 " style="width:10px;height:10px;">',
									'<path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z "></path>',
								'</svg>',
							'</div>',
						'</div>',].join('');
					});
					/* 拼出属性值 */
					function getStr(arr) {
						var strHtml = '';
						for(var i = 0; i< arr.length; i++) {
							strHtml += '<span data-valid="'+arr[i].id+'">'+arr[i].name+'</span>'
						}
						return strHtml;
					}
					// 插入字符串 并显示 高级搜索
					$_obj.find('.type-box').empty().append(str);
					// 插入折叠和展开按钮
					$_obj.find('.pc-container-box').css('position','relative')
					$_obj.find('.pc-container-box').find('.more-choose').length && $_obj.find('.pc-container-box').find('.more-choose').remove();
					$_obj.find('.type-box-group').after('<div class="more-choose">折叠<i class="switch"> <svg class="icon" viewBox="0 0 1026 1024" style="width:12px;height:12px;"> <path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z" /> </svg> </i> </div></div>');
					// 为高级搜索设置最小默认高度 超出部分隐藏 并有滚动条
					$_obj.css({
						'top': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').offset().top - $_obj.parent().offset().top + $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').height() + 'px',
						'left': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').css('left'),
						'height':4*41 + $_obj.find('.more-choose').height() + 35 + $_obj.find('.type-item').length*1 +6+'px',
					});
					// $_obj.parents('.wqdelementEditBox, .wqdelementEdit .wqdelementContent')
					$_obj.find('.type-item:last').css('border-bottom-style','solid');
					$_obj.show();
					$_obj.find('.type-box-group').show();
					$_obj.find('.nano').nanoScroller({alwaysVisible:true});
					// 绑定事件，并传入必要的参数
					self.bindEvent($_obj, data.data.categoryId, markId);
				}
			}
		});
	}

	/**
	 * 为加载后的搜索条件绑定事件
	 * @param {[Object]} $obj 传入当前高级搜索区域  对象 
	 * @param {[string]} categoryId 传入当前二级分类的分类id
	 * @param {[string]}  markId 当前对象组的markId值
	 */
	advSearch.bindEvent = function ($obj, categoryId, markId) {
		/* 点击 展开 隐藏 */
		$obj.off('click.operation').on('click.operation', '.operation', function () {
			if($(this).hasClass('on')) {
				$(this).removeClass('on')
				$(this).prev().css('overflow','hidden'); 
				$(this).siblings('.type-name').css('height','41px');
				// 图标翻转
				$(this).find('.icon').css({
					'transform':'rotate(0deg)',
					'-ms-transform':'rotate(0deg)', 	/* IE 9 */
					'-moz-transform':'rotate(0deg)', 	/* Firefox */
					'-webkit-transform':'rotate(0deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(0deg)', 	/* Opera */
				});
			} else {
				$(this).addClass('on')
				$(this).prev().css('overflow','visible'); 
				$(this).siblings('.type-name').css('height',Math.floor($(this).parents('.type-item').height() / 40)*41 + 'px');
				// 图标翻转
				$(this).find('.icon').css({
					'transform':'rotate(180deg)',
					'-ms-transform':'rotate(180deg)', 	/* IE 9 */
					'-moz-transform':'rotate(180deg)', 	/* Firefox */
					'-webkit-transform':'rotate(180deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(180deg)', 	/* Opera */
				})
			}
		});
		/* 点击关闭按钮  关闭整个浮层 */
		$obj.off('click.closeAll').on('click.closeAll', '.pc-nav-bar .closeAll', function () {
			$obj.hide();
		});
		/* 点击折叠按钮  */
		$obj.off('click.more-choose').on('click.more-choose', '.pc-container-box .more-choose', function () {
			if($(this).hasClass('on')) {
				$(this).removeClass('on')
				// 由于滚动条给type-box-group加了一个高度  所以清空  之后再加上
				$obj.find('.type-box-group').show();
				$(this).html('折叠<i class="switch"> <svg class="icon" viewBox="0 0 1026 1024" style="width:12px;height:12px;"> <path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z"></path> </svg> </i>');
				// 图标翻转
				$(this).find('.switch').css({
					'transform':'rotate(180deg)',
					'-ms-transform':'rotate(180deg)', 	/* IE 9 */
					'-moz-transform':'rotate(180deg)', 	/* Firefox */
					'-webkit-transform':'rotate(180deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(180deg)', 	/* Opera */
				});
			} else {
				$(this).addClass('on');
				$obj.find('.type-box-group').hide();
				$(this).html('展开<i class="switch"> <svg class="icon" viewBox="0 0 1026 1024" style="width:12px;height:12px;"> <path d="M1018.701913 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0L516.563478 726.416696 45.924174 255.75513c-8.704-8.704-22.77287-8.704-31.47687 0s-8.704 22.77287 0 31.47687l486.4 486.4c4.34087 4.34087 10.039652 6.522435 15.738435 6.522435s11.397565-2.181565 15.738435-6.522435l486.4-486.4C1027.383652 278.550261 1027.383652 264.45913 1018.701913 255.75513z"></path> </svg> </i>');
				// 图标翻转
				$(this).find('.switch').css({
					'transform':'rotate(0deg)',
					'-ms-transform':'rotate(0deg)', 	/* IE 9 */
					'-moz-transform':'rotate(0deg)', 	/* Firefox */
					'-webkit-transform':'rotate(0deg)', /* Safari 和 Chrome */
					'-o-transform':'rotate(0deg)', 	/* Opera */
				});
			}
		});
		/* 点击 对应的筛选条件 */
		$obj.off('click.choice').on('click.choice', '.type-content span', function () {
			// 获取属性名/值  或  规格名/值
			var attr = $(this).parent().siblings('.type-name').text();
			var val = $(this).text();
			// 插入头部
			$obj.find('.pc-nav-bar').append('<span data-id="'+$(this).data('valid')+'" data-flag="'+$(this).parents('.type-item').data('flag')+'" class="last-nav">'+attr + '/' + val+'<i class="icon-close"> <svg class="icon" viewBox="0 0 1024 1024" style="width:12px;height:12px;" fill="#e31436"> <path d="M971.292568 77.731362 945.967786 52.40658 511.698125 486.676242 77.429487 52.40658 52.104705 77.731362 486.373343 512.001023 52.104705 946.269661 77.429487 971.594443 511.698125 537.325805 945.967786 971.594443 971.292568 946.269661 537.022906 512.001023Z"></path> </svg> </i> </span>')
			$obj.find('.pc-nav-bar .need2show').show();
			// advSearch.renderShopList($(this).data('categoryId'))
			// 隐藏已被选择的选项并加载商品信息
			$(this).parents('.type-item').hide();
			// 获取已选的搜索条件id
			var idArr = [];
			$.each($obj.find('.pc-nav-bar .last-nav'), function (i, v) {
				idArr.push($(v).data('id'));
			});
			// 渲染商品列表
			advSearch.renderShopList(categoryId, idArr, markId);
			resetStyle($obj);
		});
		/* 点击导航条上面的关闭当前选筛选条件 */
		$obj.off('click.close').on('click.close', '.pc-nav-bar .last-nav svg', function () {
			// 清空当前值
			$(this).parents('.last-nav').remove();
			// 显示之前隐藏的选项
			$obj.find('.type-box .type-item[data-flag="'+$(this).parents('.last-nav').data('flag')+'"]').show();
			// 获取已选的搜索条件id
			var idArr = [];
			$.each($obj.find('.pc-nav-bar .last-nav'), function (i, v) {
				idArr.push($(v).data('id'));
			});
			/* 先执行展开操作 放置样式错乱 */
			if($obj.find('.pc-container-box .more-choose.on').length) $obj.find('.pc-container-box .more-choose').click();
			// 渲染数据/*  */
			advSearch.renderShopList(categoryId, idArr, markId);
			resetStyle($obj);
		});
		function resetStyle ($_obj) {
			// 设置高级搜索对象 始终跟随分类导航条  并与之左对齐
			$_obj.css({
				'top': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').offset().top - $_obj.parent().offset().top + $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').height() + 'px',
				'left': $_obj.siblings('.wqdcommodityCategory[wqdmark="'+markId+'"]').css('left'),
				'height':4*41 + 6+ $_obj.find('.more-choose').height() +  $_obj.find('.pc-nav-bar').height()+'px',
			});
			// 加入 搜索条件已被全部选完，则nav 下边框也变为实心的
			if(!$_obj.find('.type-box .type-item:visible').length) {
				$_obj.find('.type-box').css('border-top-color','transparent');
				$_obj.find('.pc-nav-bar').css({
					'border-bottom-right-radius': '3px',
					'border-bottom-left-radius': '3px',
					'border-bottom-color':'rgb(220, 220, 220)'
				})
			} else {
				$_obj.find('.type-box').css('border-top-color','rgba(220, 220, 220, 1)');
				$_obj.find('.pc-nav-bar').css({
					'border-bottom-right-radius': '0px',
					'border-bottom-left-radius': '0px',
					'border-bottom-color':'transparent'
				})
			}
			$_obj.find('.type-item:last').css('border-bottom-style','solid');
		}
	}

	/**
	 * 渲染商品列表 
	 * @param {[Object]} categoryId 传入当前二级分类的分类id
	 * @param {[Array]} idArr 传入选择的 属性或规格值id数组
	 * @param {[string]}  markId 当前对象组的markId值
	 */
	advSearch.renderShopList = function (categoryId, idArr, markId) {
		// 更新数据
		// 获取 参数
		var contactId = markId,
		modityDom = $(".wqdcommodityList[wqdmark="+contactId+"]"),
		stype = modityDom.attr("sorttype") || "time",
		USERID = modityDom.attr("userid") || "";
		// 调用commodityList.requestDate()  方法执行ajax 请求  渲染商品列表
		// categoryid = $(this).attr("data-category") || (modityDom.attr("data-categoryids") ? modityDom.attr("data-categoryids") : "");
		commodityList.requestDate("/fixed/item/getItems",{userId:USERID,categoryId:categoryId,sortType:stype,properyId:idArr.join(',')},function(data){
			// modityDom.data("cacheData",data.data);	//缓存数据
			data.status == 200 && commodityList.dataInit.call(modityDom, data.data);
		});
	}
});	
